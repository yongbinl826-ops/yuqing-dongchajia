# èˆ†æƒ…æ´å¯Ÿå®¶é¡¹ç›®äº¤æ¥æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°ï¼š** èˆ†æƒ…æ´å¯Ÿå®¶ (Yuqing Dongchajia)  
**é¡¹ç›®ç±»å‹ï¼š** ä¸­æ–‡èˆ†æƒ…ç›‘æ§ä¸æƒ…æ„Ÿåˆ†æç³»ç»Ÿ  
**æŠ€æœ¯æ ˆï¼š** React 19 + Express + Python + MySQL  
**äº¤æ¥æ—¥æœŸï¼š** 2025-11-22  
**å½“å‰ç‰ˆæœ¬ï¼š** 1.0.0

## ğŸ¯ é¡¹ç›®åŠŸèƒ½

### å·²å®ŒæˆåŠŸèƒ½

1. **å¤šå¹³å°æ•°æ®é‡‡é›†**
   - âœ… Twitteræ•°æ®é‡‡é›†ï¼ˆå·²é€‚é…Free APIï¼‰
   - âœ… å¾®åšçˆ¬è™«ï¼ˆåŸºäºPlaywrightï¼‰
   - âœ… çŸ¥ä¹çˆ¬è™«ï¼ˆåŸºäºPlaywrightï¼‰
   - âœ… æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆå™¨ï¼ˆç”¨äºæ¼”ç¤ºï¼‰

2. **NLPæƒ…æ„Ÿåˆ†æ**
   - âœ… FastAPIæœåŠ¡ï¼ˆç«¯å£8000ï¼‰
   - âœ… åŸºäºè§„åˆ™çš„ä¸­æ–‡æƒ…æ„Ÿåˆ†æ
   - âœ… Jiebaåˆ†è¯å’Œå…³é”®è¯æå–
   - âœ… æ‰¹é‡å¤„ç†æ”¯æŒ

3. **æ•°æ®å¯è§†åŒ–**
   - âœ… æƒ…æ„Ÿè¶‹åŠ¿å›¾è¡¨ï¼ˆPlotlyï¼‰
   - âœ… æƒ…æ„Ÿåˆ†å¸ƒé¥¼å›¾
   - âœ… æ—¶é—´èŒƒå›´åˆ‡æ¢ï¼ˆ7å¤©/30å¤©ï¼‰
   - âœ… å®æ—¶è¿›åº¦æ˜¾ç¤º

4. **ä»»åŠ¡ç®¡ç†**
   - âœ… åˆ›å»ºç›‘æ§ä»»åŠ¡
   - âœ… å¯åŠ¨/åœæ­¢é‡‡é›†
   - âœ… æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…
   - âœ… æ•°æ®å¯¼å‡ºï¼ˆCSVï¼‰

### å¾…å®Œå–„åŠŸèƒ½

1. **OAuthç”¨æˆ·è®¤è¯**
   - â³ éœ€è¦é…ç½®çœŸå®OAuthæœåŠ¡å™¨
   - ğŸ’¡ å½“å‰ä½¿ç”¨é»˜è®¤ç”¨æˆ·ï¼ˆæ¸¸å®¢æ¨¡å¼ï¼‰

2. **å¾®åš/çŸ¥ä¹ç™»å½•**
   - â³ éœ€è¦å¤„ç†éªŒè¯ç 
   - â³ éœ€è¦ä¼˜åŒ–åçˆ¬è™«ç­–ç•¥

3. **Twitter APIå‡çº§**
   - â³ å½“å‰ä½¿ç”¨Freeè®¡åˆ’ï¼ˆé™åˆ¶100æ¡/æœˆï¼‰
   - ğŸ’¡ å»ºè®®å‡çº§åˆ°Basicè®¡åˆ’ï¼ˆ$200/æœˆï¼‰

4. **BERTæ¨¡å‹é›†æˆ**
   - â³ å½“å‰ä½¿ç”¨è§„åˆ™åˆ†æ
   - ğŸ’¡ å¯é›†æˆé¢„è®­ç»ƒBERTæ¨¡å‹æå‡å‡†ç¡®åº¦

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
yuqing_dongchajia/
â”œâ”€â”€ client/                    # Reactå‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/            # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ components/       # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ lib/              # å·¥å…·åº“
â”‚   â”‚   â””â”€â”€ _core/            # æ ¸å¿ƒåŠŸèƒ½
â”‚   â””â”€â”€ public/               # é™æ€èµ„æº
â”œâ”€â”€ server/                    # Expressåç«¯
â”‚   â”œâ”€â”€ _core/                # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ routers/              # APIè·¯ç”±
â”‚   â”œâ”€â”€ collectors/           # æ•°æ®é‡‡é›†å™¨
â”‚   â””â”€â”€ db.ts                 # æ•°æ®åº“æ“ä½œ
â”œâ”€â”€ drizzle/                   # æ•°æ®åº“Schema
â”œâ”€â”€ nlp_service.py            # NLPæœåŠ¡
â”œâ”€â”€ requirements.txt          # Pythonä¾èµ–
â”œâ”€â”€ package.json              # Node.jsä¾èµ–
â”œâ”€â”€ .env                      # ç¯å¢ƒå˜é‡
â””â”€â”€ database_backup.sql       # æ•°æ®åº“å¤‡ä»½

```

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

1. **monitoring_tasks** - ç›‘æ§ä»»åŠ¡
   - id, userId, keyword, description, platforms, status
   - createdAt, updatedAt

2. **comments** - é‡‡é›†çš„è¯„è®ºæ•°æ®
   - id, taskId, platform, content, author, url
   - publishedAt, createdAt

3. **sentiment_analysis** - æƒ…æ„Ÿåˆ†æç»“æœ
   - id, commentId, taskId, sentiment, confidence, keywords
   - createdAt

4. **sentiment_stats** - æƒ…æ„Ÿç»Ÿè®¡ï¼ˆæŒ‰å¤©èšåˆï¼‰
   - id, taskId, date, positiveCount, negativeCount, neutralCount

5. **crawl_jobs** - é‡‡é›†ä»»åŠ¡è®°å½•
   - id, taskId, status, totalItems, processedItems, errorMessage
   - startedAt, completedAt

6. **users** - ç”¨æˆ·è¡¨
   - id, openId, name, email, role, lastSignedIn

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…Node.jsä¾èµ–
cd yuqing_dongchajia
pnpm install

# å®‰è£…Pythonä¾èµ–
pip3 install -r requirements.txt

# å®‰è£…Playwrightæµè§ˆå™¨
sudo playwright install chromium

# å®‰è£…MySQL
sudo apt-get install mysql-server
```

### 2. æ•°æ®åº“é…ç½®

```bash
# å¯åŠ¨MySQL
sudo service mysql start

# æ¢å¤æ•°æ®åº“å¤‡ä»½
mysql -u root -p < database_backup.sql

# æˆ–åˆ›å»ºæ–°æ•°æ®åº“
mysql -u root -p << EOF
CREATE DATABASE IF NOT EXISTS yuqing_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER IF NOT EXISTS 'yuqing_user'@'localhost' IDENTIFIED BY 'yuqing_pass_2024';
GRANT ALL PRIVILEGES ON yuqing_db.* TO 'yuqing_user'@'localhost';
FLUSH PRIVILEGES;
EOF

# æ¨é€Schema
export DATABASE_URL="mysql://yuqing_user:yuqing_pass_2024@localhost:3306/yuqing_db"
pnpm db:push
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
# æ•°æ®åº“é…ç½®
DATABASE_URL=mysql://yuqing_user:yuqing_pass_2024@localhost:3306/yuqing_db

# Twitter APIï¼ˆéœ€è¦è‡ªè¡Œç”³è¯·ï¼‰
TWITTER_API_KEY=your_api_key
TWITTER_API_SECRET=your_api_secret
TWITTER_ACCESS_TOKEN=your_access_token
TWITTER_ACCESS_TOKEN_SECRET=your_access_token_secret

# OAuthé…ç½®ï¼ˆå¯é€‰ï¼‰
OAUTH_SERVER_URL=http://localhost:9999
VITE_OAUTH_PORTAL_URL=http://localhost:9999
VITE_APP_ID=yuqing_dongchajia
JWT_SECRET=your-jwt-secret-key

# NLPæœåŠ¡
NLP_SERVICE_URL=http://localhost:8000
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼1ï¼šä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬
./start_all.sh

# æ–¹å¼2ï¼šæ‰‹åŠ¨å¯åŠ¨å„æœåŠ¡
# å¯åŠ¨MySQL
sudo service mysql start

# å¯åŠ¨NLPæœåŠ¡
python3 nlp_service.py > nlp_service.log 2>&1 &

# å¯åŠ¨Webåº”ç”¨
export $(cat .env | grep -v '^#' | xargs)
pnpm dev
```

è®¿é—®ï¼šhttp://localhost:3000

## ğŸ“Š æ¼”ç¤ºæ•°æ®

æ•°æ®åº“å¤‡ä»½ä¸­åŒ…å«45æ¡æ¨¡æ‹Ÿæ•°æ®ï¼ˆä»»åŠ¡ID=1ï¼Œå…³é”®è¯"AI"ï¼‰ï¼š
- Twitterï¼š15æ¡
- å¾®åšï¼š15æ¡
- çŸ¥ä¹ï¼š15æ¡

å¯ä»¥ç›´æ¥æŸ¥çœ‹æ¼”ç¤ºæ•ˆæœã€‚

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„æ•°æ®æº

1. åœ¨ `server/collectors/` åˆ›å»ºæ–°çš„é‡‡é›†å™¨
2. ç»§æ‰¿åŸºç¡€é‡‡é›†å™¨ç±»æˆ–å‚è€ƒç°æœ‰å®ç°
3. åœ¨ `run_collector.py` ä¸­æ³¨å†Œæ–°å¹³å°
4. æ›´æ–°å‰ç«¯å¹³å°é€‰æ‹©å™¨

### ä¿®æ”¹æƒ…æ„Ÿåˆ†æé€»è¾‘

ç¼–è¾‘ `server/nlp/sentiment_analyzer.py`ï¼š

```python
def analyze_sentiment(self, text: str) -> dict:
    # è‡ªå®šä¹‰åˆ†æé€»è¾‘
    # å¯ä»¥é›†æˆBERTã€LSTMç­‰æ¨¡å‹
    pass
```

### æ·»åŠ æ–°çš„APIç«¯ç‚¹

åœ¨ `server/routers.ts` ä¸­æ·»åŠ ï¼š

```typescript
export const appRouter = router({
  // æ·»åŠ æ–°çš„è·¯ç”±
  myNewRoute: router({
    myMethod: publicProcedure
      .input(z.object({ ... }))
      .query(async ({ input }) => {
        // å®ç°é€»è¾‘
      }),
  }),
});
```

## ğŸ› å·²çŸ¥é—®é¢˜

### 1. OAuthæœªé…ç½®
**ç°è±¡ï¼š** ç”¨æˆ·è®¤è¯åŠŸèƒ½ä¸å¯ç”¨  
**å½±å“ï¼š** ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½ï¼Œå½“å‰ä½¿ç”¨æ¸¸å®¢æ¨¡å¼  
**è§£å†³ï¼š** é…ç½®çœŸå®OAuthæœåŠ¡å™¨æˆ–é›†æˆç¬¬ä¸‰æ–¹ç™»å½•

### 2. Twitter APIé™åˆ¶
**ç°è±¡ï¼š** Freeè®¡åˆ’æ¯æœˆåªèƒ½é‡‡é›†100æ¡  
**å½±å“ï¼š** æ— æ³•å¤§è§„æ¨¡é‡‡é›†Twitteræ•°æ®  
**è§£å†³ï¼š** å‡çº§åˆ°Basicè®¡åˆ’ï¼ˆ$200/æœˆï¼‰æˆ–ä½¿ç”¨å…¶ä»–æ•°æ®æº

### 3. å¾®åš/çŸ¥ä¹éªŒè¯ç 
**ç°è±¡ï¼š** ç™»å½•æ—¶å¯èƒ½é‡åˆ°éªŒè¯ç   
**å½±å“ï¼š** è‡ªåŠ¨åŒ–é‡‡é›†å¯èƒ½å¤±è´¥  
**è§£å†³ï¼š** 
- ä½¿ç”¨ç¨³å®šçš„å°å·
- é™ä½é‡‡é›†é¢‘ç‡
- è€ƒè™‘ä½¿ç”¨ä»£ç†IP

### 4. TaskDetailé¡µé¢åŠ è½½é—®é¢˜
**ç°è±¡ï¼š** æœ‰æ—¶æ˜¾ç¤º"ä»»åŠ¡ä¸å­˜åœ¨"  
**å½±å“ï¼š** éœ€è¦åˆ·æ–°é¡µé¢  
**è§£å†³ï¼š** å·²ä¿®å¤isActiveåˆå§‹åŒ–é—®é¢˜ï¼Œä½†APIè¿æ¥ä»éœ€ä¼˜åŒ–

## ğŸ“ ç»´æŠ¤å»ºè®®

### æ—¥å¸¸ç»´æŠ¤

1. **æ•°æ®åº“å¤‡ä»½**
   ```bash
   mysqldump -u yuqing_user -pyuqing_pass_2024 yuqing_db > backup_$(date +%Y%m%d).sql
   ```

2. **æ—¥å¿—ç›‘æ§**
   ```bash
   tail -f nlp_service.log
   tail -f /tmp/yuqing_server.log
   ```

3. **æ¸…ç†æ—§æ•°æ®**
   ```sql
   DELETE FROM comments WHERE createdAt < DATE_SUB(NOW(), INTERVAL 90 DAY);
   ```

### æ€§èƒ½ä¼˜åŒ–

1. **æ•°æ®åº“ç´¢å¼•**
   - å·²åœ¨taskIdã€platformã€createdAtä¸Šå»ºç«‹ç´¢å¼•
   - å¯æ ¹æ®æŸ¥è¯¢æ¨¡å¼æ·»åŠ ç»„åˆç´¢å¼•

2. **ç¼“å­˜ç­–ç•¥**
   - å¯ä½¿ç”¨Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
   - æƒ…æ„Ÿç»Ÿè®¡å¯ä»¥é¢„è®¡ç®—

3. **å¹¶å‘é‡‡é›†**
   - å½“å‰ä¸²è¡Œé‡‡é›†
   - å¯æ”¹ä¸ºå¤šçº¿ç¨‹/å¤šè¿›ç¨‹å¹¶å‘

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

1. **APIå¯†é’¥ç®¡ç†**
   - âš ï¸ ä¸è¦å°†`.env`æ–‡ä»¶æäº¤åˆ°Git
   - âš ï¸ ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†æœåŠ¡

2. **æ•°æ®åº“å®‰å…¨**
   - âš ï¸ ä¿®æ”¹é»˜è®¤æ•°æ®åº“å¯†ç 
   - âš ï¸ é™åˆ¶æ•°æ®åº“è®¿é—®IP

3. **ç”¨æˆ·è®¤è¯**
   - âš ï¸ å½“å‰æ— è®¤è¯ï¼Œæ‰€æœ‰ç”¨æˆ·å…±äº«æ•°æ®
   - âš ï¸ ç”Ÿäº§ç¯å¢ƒå¿…é¡»å¯ç”¨OAuth

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### ç›¸å…³æ–‡æ¡£

- `README.md` - é¡¹ç›®è¯´æ˜
- `QUICK_START.md` - å¿«é€Ÿå¯åŠ¨æŒ‡å—
- `CRAWLER_GUIDE.md` - çˆ¬è™«å¼€å‘æŒ‡å—
- `todo.md` - å¾…åŠäº‹é¡¹æ¸…å•

### å¸¸è§å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
ps aux | grep -E "(python3|node|pnpm)"

# é‡å¯æ‰€æœ‰æœåŠ¡
./start_all.sh

# æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€
mysql -u yuqing_user -pyuqing_pass_2024 yuqing_db -e "SHOW TABLES;"

# æµ‹è¯•NLPæœåŠ¡
curl -X POST http://localhost:8000/analyze \
  -H "Content-Type: application/json" \
  -d '{"text":"è¿™ä¸ªäº§å“çœŸä¸é”™ï¼"}'
```

## ğŸ“ å­¦ä¹ èµ„æº

- **React 19**: https://react.dev/
- **tRPC**: https://trpc.io/
- **Drizzle ORM**: https://orm.drizzle.team/
- **Playwright**: https://playwright.dev/
- **Jiebaåˆ†è¯**: https://github.com/fxsjy/jieba
- **Twitter API**: https://developer.twitter.com/

## ğŸ“¦ äº¤æ¥æ¸…å•

- âœ… å®Œæ•´æºä»£ç 
- âœ… æ•°æ®åº“å¤‡ä»½ï¼ˆå«æ¼”ç¤ºæ•°æ®ï¼‰
- âœ… ç¯å¢ƒé…ç½®æ–‡ä»¶
- âœ… Pythonä¾èµ–åˆ—è¡¨
- âœ… Node.jsä¾èµ–åˆ—è¡¨
- âœ… é¡¹ç›®æ–‡æ¡£
- âœ… å¿«é€Ÿå¯åŠ¨è„šæœ¬
- âœ… å·²çŸ¥é—®é¢˜åˆ—è¡¨
- âœ… å¼€å‘å»ºè®®

## ğŸš€ åç»­å¼€å‘å»ºè®®

### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰

1. ä¿®å¤TaskDetailé¡µé¢APIè¿æ¥é—®é¢˜
2. ä¼˜åŒ–å¾®åš/çŸ¥ä¹ç™»å½•æµç¨‹
3. æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½ï¼ˆExcelï¼‰
4. å®Œå–„é”™è¯¯å¤„ç†å’Œæ—¥å¿—

### ä¸­æœŸï¼ˆ1-2æœˆï¼‰

1. é›†æˆBERTæƒ…æ„Ÿåˆ†ææ¨¡å‹
2. æ·»åŠ çƒ­ç‚¹è¯é¢˜å‘ç°
3. å®ç°èˆ†æƒ…é¢„è­¦åŠŸèƒ½
4. å¤šç”¨æˆ·æƒé™ç®¡ç†

### é•¿æœŸï¼ˆ3-6æœˆï¼‰

1. æ·»åŠ æ›´å¤šå¹³å°ï¼ˆæŠ–éŸ³ã€å°çº¢ä¹¦ã€Bç«™ï¼‰
2. GPTé›†æˆï¼ˆæ‘˜è¦ç”Ÿæˆã€æŠ¥å‘Šæ’°å†™ï¼‰
3. Dockerå®¹å™¨åŒ–éƒ¨ç½²
4. åˆ†å¸ƒå¼é‡‡é›†æ¶æ„

---

**ç¥å¼€å‘é¡ºåˆ©ï¼å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒæ–‡æ¡£æˆ–è”ç³»å‰ä»»å¼€å‘è€…ã€‚**
